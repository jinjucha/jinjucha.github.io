### **디자인 패턴이란?**

일반적으로 우리가 말하는 디자인 패턴은 주로 객체지향 프로그래밍 언어로 소프트웨어를 개발할 때, 특정 상황에서 자주 나타나는 문제를 해결하기 위해 수많은 개발자가 쌓아온 **솔루션**입니다.

개발을 구조적으로 우아하게 설계하려고 노력하다보니 반복되는 패턴들이 발견됐는데 그걸 바로 **디자인 패턴**이라고 합니다.

| 생성 패턴 (5개) |
| --- |
| 싱글톤 (Singleton) |
| 팩토리 메소드 (Factory Method) |
| 추상 팩토리 (Abstract Factory) |
| 빌더 (Builder) |
| 프로토타입 (Prototype) |

## 생성패턴(Creational Patterns) 이란?

생성패턴은 객체의 생성에 관련된 패턴으로 객체의 생성절차를 추상화하는 패턴이다. 객체를 생성-합성하는 방법 / 객체의 표현방법과 시스템을 분리한다.

## 생성패턴 특징

1. 생성패턴은 시스템이 어떤 구체 클래스(구체적인 클래스)를 사용하는지에 대한 정보를 캡슐화한다.
2. 생성패턴은 이들 클래스의 인스턴스들이 어떻게 만들고 어떻게 서로 맞붙는지에 대한 부분을 완전히 가린다.

즉, 객체의 생성과 조합을 캡슐화해 특정 객체가 생성되거나 변경되어도 프로그램 구조에 영향을 크게 받지 않도록 유연성을 제공한다.

## 생성패턴 종류

생성패턴에는 아래와 같은 디자인 패턴이 존재한다.

1. 추상 팩토리 패턴(Abstract Factory Pattern): 공통의 속성이나 기능의 팩토리를 묶어 준다.
2. 빌더 패턴(Builder Pattern): 생성(construction)과 표기(representation)를 분리해 복잡한 객체를 생성한다.
3. 팩토리 메서드 패턴(Factory Method Pattern): 생성할 객체의 클래스를 국한하지 않고 객체를 생성한다.
4. 프로토타입 패턴(Prototype Pattern): 기존 객체를 복제함으로써 객체를 생성한다.
5. 싱글턴 패턴(Singleton pattern): 한 클래스에 한 객체만 존재하도록 제한한다.

## 1. 추상 팩토리 패턴(Abstract Factory Pattern)

- 추상 팩토리 패턴이란?

비슷한 속성의 객체들을 인터페이스로 규격화된 팩토리에서 일관된 방식으로 생성하고, 생성된 객체끼리는 쉽게 교체될 수 있도록 고안한 패턴이다.

추상 팩토리 패턴은 상세화된 서브클래스를 정의하지 않고도 서로 관련성이 있거나 독립적인 여러 객체의 군을 생성하기 위한 인터페이스를 제공한다.

## 2. 빌더 패턴(Builder Pattern)

- 빌더 패턴이란?

복잡한 객체를 생성하는 방법을 정의하는 클래스와 표현하는 방법을 정의하는 클래스를 별도로 분리하여,서로 다른 표현이라도 이를 생성할 수 있는 동일한 절차를 제공하는 패턴이다.

빌더 패턴은 많은 Optional한 멤버 변수(혹은 파라미터)나 지속성 없는 상태 값들에 대해 처리해야 하는 문제들을 해결한다.

예를 들어, 팩토리 패턴이나 추상 팩토리 패턴에서는 생성해야하는 클래스에 대한 속성 값이 많을 때 아래와 같은 이슈들이 있다.

1. 클라이언트 프로그램으로부터 팩토리 클래스로 많은 파라미터를 넘겨줄 때 타입, 순서 등에 대한 관리가 어려워져 에러가 발생할 확률이 높아진다.
2. 경우에 따라 필요 없는 파라미터들에 대해서 팩토리 클래스에 일일이 null 값을 넘겨줘야 한다.
3. 생성해야 하는 sub class가 무거워지고 복잡해짐에 따라 팩토리 클래스 또한 복잡해진다.

빌더 패턴은 이러한 문제들을 해결하기 위해 별도의 Builder 클래스를 만들어 필수 값에 대해서는 생성자를 통해, 선택적인 값들에 대해서는 메소드를 통해 step-by-step으로 값을 입력받은 후에 build() 메소드를 통해 최종적으로 하나의 인스턴스를 리턴하는 방식이다.

빌더 패턴은 굉장히 자주 사용되는 생성 패턴 중 하나로, Retrofit이나 Okhttp 등 유명 오픈소스에서도 이 빌더 패턴을 사용하고 있다.

### **[ 빌더 패턴(Builder Pattern)의 장점 ]**

1. 필요한 데이터만 설정할 수 있음
2. 유연성을 확보할 수 있음
3. 가독성을 높일 수 있음
4. 변경 가능성을 최소화할 수 있음

- 빌더 패턴을 구현하는 방법
1. 빌더 클래스를 Static Nested Class로 생성한다.이때, 관례적으로 생성하고자 하는 클래스 이름 뒤에 Builder를 붙인다.예를 들어, Computer 클래스에 대한 빌더 클래스의 이름은 ComputerBuilder 라고 정의한다.
2. 빌더 클래스의 생성자는 public으로 하며, 필수 값들에 대해 생성자의 파라미터로 받는다.
3. 옵셔널한 값들에 대해서는 각각의 속성마다 메소드로 제공하며, 이때 중요한 것은 메소드의 리턴 값이 빌더 객체 자신이어야 한다.
4. 마지막 단계로, 빌더 클래스 내에 build() 메소드를 정의하여 클라이언트 프로그램에게 최종 생성된 결과물을 제공한다. 이렇듯 build()를 통해서만 객체 생성을 제공하기 때문에 생성 대상이 되는 클래스의 생성자는 private으로 정의해야 한다.

```java
public class NutritionFactsMain {
    public static void main(String[] args) {
        NutritionFacts cocaCola = new NutritionFacts
                .Builder(240, 8)    // 필수값 입력
                .calories(100)
                .sodium(35)
                .carbohydrate(27)
                .build();           // build() 가 객체를 생성해 돌려준다.

        System.out.println(cocaCola.toString());
    }
}
```

## 3. 팩토리 메서드 패턴(Factory Method Pattern)

- 팩토리 메서드 패턴이란?

팩토리 메서드 패턴은 객체를 생성하기 위해 인터페이스를 정의하지만 어떤 클래스의 인스턴스를 생성할 지에 대한 결정은 서브클래스가 내리도록 할 때 유용하게 사용된다.어떤 클래스가 자신이 생성해야 하는 객체의 클래스를 예측할 수 없을때 사용한다.

- 팩토리 메서드 패턴 구현시 고려할 점들

팩토리 메소드 패턴의 구현 방법은 크게 두 가지가 있다.

1. Creator를 추상 클래스로 정의하고, 팩토리 메소드는 abstract로 선언하는 방법.
2. Creator가 구체 클래스이고, 팩토리 메소드의 기본 구현을 제공하는 방법.

팩토리 메소드의 인자를 통해 다양한 Product를 생성하게 한다.

1. 팩토리 메소드에 잘못된 인자가 들어올 경우의 런타임 에러 처리에 대해 고민할 것.
2. [Enum](https://www.notion.so/enum-9fb89127e8344e678e6911cc72f5250d?pvs=21) 등을 사용하는 것도 고려할 필요가 있다.

[enum정의, 예제](https://www.notion.so/enum-9fb89127e8344e678e6911cc72f5250d?pvs=21)

---

**Builder Pattern vs Factory method pattern**

**팩토리 매서드 패턴**에서는 전체 오브젝트를 위한 한번의 함수 호출이 요구된다. 

하나의 라인에 모든 파라미터들이 전달되어야 하며 최종 오브젝트가 리턴될 것이다.

실제 생활에서 예를 찾아보면 레스토랑의 오늘의 식사와 같다. 식사의 생성은 팩토리 패턴이다.

때문에 우리는 주문할때 오늘의 식사를 달라고 하고 이러한 오브젝트는 비밀의 기준에 의해 생성된 식사를 제공한다.

**빌더 패턴**은 생성자를 위해 전달가능한 모든 파라미터의 래퍼 오브젝트이다. 여기서는 생성을 위한 파라미터를 전달하기 위한 세터가 허용된다.

실제 생활에서의 예는 커스텀 피자이다. 이 경우 추가 치즈라던지, 올리브, 옥수수들을 커스터마이징 할 수 있다.

---

## 4. 프로토타입 패턴(Prototype Pattern)

- 프로토 타입 패턴이란?

프로토타입은 주로 실제 제품을 만들기에 앞서 대략적인 샘플 정도의 의미로 사용되는 단어이다.

생성할 객체들의 타입이 프로토타입인 인스턴스로부터 결정되도록 하며 인스턴스는 새 객체를 만들기 위해 자신을 복제(clone)하게 된다.

패턴을 구현하려면 우선 clone() 메소드를 선언하는 추상 클래스를 하나 만든다.다형적 생성자(polymorphic constructor) 기능이 필요한 클래스가 있다면 위의 추상 클래스를 상속받게 한 후, clone() 메소드 내의 코드를 구현한다.

- 프로토 타입 패턴 특징
1. 추상 팩토리 패턴과는 반대로 클라이언트 응용 프로그램 코드 내에서 객체 창조자(creator)를 서브클래스(subclass)하는 것을 피할 수 있게 해준다.
2. 새로운 객체는 일반적인 방법(예를 들어, new를 사용해서라든지)으로 객체를 생성(create)하는 고유의 비용이 주어진 응용 프로그램 상황에 있어서 불가피하게 매우 클 때, 이 비용을 감내하지 않을 수 있게 해준다.

즉, 객체를 복사하여 생성하는 방식이므로 다수의 객체를 생성해야 할 경우 객체 생성의 비용을 효과적으로 감소시킬 수 있다. 프로토 타입이 존재하고 복제만 해서 객체를 생성하게 되므로 서브 클래스의 수를 줄일 수 있다는 장점도 있다.

## 5. 싱글턴 패턴(Singleton pattern)

- 싱글턴 패턴이란?

싱글턴 패턴은 인스턴스를 하나만 만들어 사용하기 위한 패턴이다.커넥션 풀, 스레드 풀, 디바이스 설정 객체 등의 경우 인스턴스를 여러 개 만들게 되면 자원을 낭비하게 되거나 버그를 발생시킬 수 있으므로 오직 하나만 생성하고 그 인스턴스를 사용하도록 하는 것이 이 패턴의 목적이다.

하나의 인스턴스만을 유지하기 위해 인스턴스 생성에 특별한 제약을 걸어둬야 한다.new를 실행할 수 없도록 생성자에 private 접근 제어자를 지정하고, 유일한 단일 객체를 반환할 수 있도록 정적 메소드를 지원해야 한다. 또한 유일한 단일 객체를 참조할 정적 참조변수가 필요하다.

- 싱글턴 패턴의 문제점
1. 싱글톤은 프로그램 전체에서 하나의 객체만을 공통으로 사용하고 있기 때문에 각 객체간의 결합도가 높아지고 변경에 유연하게 대처할 수 없다. 싱글톤 객체가 변경되면 이를 참조하고 있는 모든 값들이 변경되어야 하기 때문이다.
2. 멀티쓰레드 환경에서 대처가 어느정도 가능하지만 고려해야 할 요소가 많아 사용이 어렵고, 프로그램 전반에 걸쳐서 필요한 부분에만 사용한다면 장점이 있다. 하지만 그 포인트를 잡기가 어렵다
